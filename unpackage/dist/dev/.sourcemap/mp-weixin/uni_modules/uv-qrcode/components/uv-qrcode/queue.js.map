{"version":3,"file":"queue.js","sources":["uni_modules/uv-qrcode/components/uv-qrcode/queue.js"],"sourcesContent":["function Queue() {\r\n  let waitingQueue = this.waitingQueue = [];\r\n  let isRunning = this.isRunning = false; // 记录是否有未完成的任务\r\n\r\n  function execute(task, resolve, reject) {\r\n    task()\r\n      .then((data) => {\r\n        resolve(data);\r\n      })\r\n      .catch((e) => {\r\n        reject(e);\r\n      })\r\n      .finally(() => {\r\n        // 等待任务队列中如果有任务，则触发它；否则设置isRunning = false,表示无任务状态\r\n        if (waitingQueue.length) {\r\n          const next = waitingQueue.shift();\r\n          execute(next.task, next.resolve, next.reject);\r\n        } else {\r\n          isRunning = false;\r\n        }\r\n      });\r\n  }\r\n  this.exec = function(task) {\r\n    return new Promise((resolve, reject) => {\r\n      if (isRunning) {\r\n        waitingQueue.push({\r\n          task,\r\n          resolve,\r\n          reject\r\n        });\r\n      } else {\r\n        isRunning = true;\r\n        execute(task, resolve, reject);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\n/* 队列实例，某些平台一起使用多个组件时需要通过队列逐一绘制，否则部分绘制方法异常，nvue端的iOS gcanvas尤其明显，在不通过队列绘制时会出现图片丢失的情况 */\r\nexport const queueDraw = new Queue();\r\nexport const queueLoadImage = new Queue();"],"names":[],"mappings":";AAAA,SAAS,QAAQ;AACf,MAAI,eAAe,KAAK,eAAe;AACvC,MAAI,YAAY,KAAK,YAAY;AAEjC,WAAS,QAAQ,MAAM,SAAS,QAAQ;AACtC,SAAM,EACH,KAAK,CAAC,SAAS;AACd,cAAQ,IAAI;AAAA,IACpB,CAAO,EACA,MAAM,CAAC,MAAM;AACZ,aAAO,CAAC;AAAA,IAChB,CAAO,EACA,QAAQ,MAAM;AAEb,UAAI,aAAa,QAAQ;AACvB,cAAM,OAAO,aAAa;AAC1B,gBAAQ,KAAK,MAAM,KAAK,SAAS,KAAK,MAAM;AAAA,MACtD,OAAe;AACL,oBAAY;AAAA,MACb;AAAA,IACT,CAAO;AAAA,EACJ;AACD,OAAK,OAAO,SAAS,MAAM;AACzB,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,UAAI,WAAW;AACb,qBAAa,KAAK;AAAA,UAChB;AAAA,UACA;AAAA,UACA;AAAA,QACV,CAAS;AAAA,MACT,OAAa;AACL,oBAAY;AACZ,gBAAQ,MAAM,SAAS,MAAM;AAAA,MAC9B;AAAA,IACP,CAAK;AAAA,EACF;AACH;AAGY,MAAC,YAAY,IAAI,MAAQ;AACzB,MAAC,iBAAiB,IAAI,MAAK;;;"}